<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Socket.IO Test Client</title>
  <!-- Sử dụng phiên bản Socket.IO client từ CDN -->
  <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"></script>
</head>
<body>
  <h2>Socket.IO Test Client</h2>
  <div id="log"></div>
  <script>
    // Kết nối đến server Socket.IO của bạn (cần điều chỉnh URL nếu khác)
    const socket = io('http://localhost:3002', {
      transports: ['websocket']
    });

    // Hàm để in log lên trang
    function writeLog(message) {
      const logDiv = document.getElementById('log');
      logDiv.innerHTML += `<p>${message}</p>`;
      console.log(message);
    }

    // Khi kết nối thành công
    socket.on('connect', () => {
      writeLog('Connected with id: ' + socket.id);

      // Tham gia phòng chat
      const roomId = 'room1';
      writeLog('Joining room: ' + roomId);
      socket.emit('joinRoom', roomId);

      // Thử gửi tin nhắn
      setTimeout(() => {
        const messageData = {
          roomId: roomId,
          sender: 'user1',
          text: 'Hello, this is a test message!',
          createdAt: new Date()
        };
        writeLog('Sending message: ' + JSON.stringify(messageData));
        socket.emit('chatMessage', messageData);
      }, 1000);
    });

    // Nhận tin nhắn
    socket.on('chatMessage', (data) => {
      writeLog('Received chat message: ' + JSON.stringify(data));
    });

    // Xử lý sự kiện disconnect
    socket.on('disconnect', () => {
      writeLog('Disconnected from server.');
    });
  </script>
</body>
</html>
